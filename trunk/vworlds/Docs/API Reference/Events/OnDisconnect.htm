
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<Link rel="Stylesheet" href="../APIRef.css">
	<title>OnDisconnect</title>
</head>
<body>

<!--Header table -->
<table class="head" >
	<tr>
		<td><h2>OnDisconnect</h2></td>
		<td class="space"></td>
		<td class="methodpic"><!--image is inserted here--></td>
		<td class="greyed">Event Handler</td>
	</tr>
</table>

<!--Topic Definition-->
<p>An event-handling method that is called in response to the <strong>Disconnect</strong>
event, which occurs when an <strong>Avatar</strong> disconnects
from a world.
<!--Syntax table-->
<H3>Syntax</H3>
<table class="backlight">
	<tr>
    	<td><b>Sub </b><b>OnDisconnect(<i>pAvatar</i>)</b>
<br>&nbsp;&nbsp;&nbsp;&nbsp;<i>statements</i><br>
<b>End Sub</b></td>
	</tr>
</table>


<!--Parameters table-->
<p>The <b>OnDisconnect</b> method syntax has these parts:
<TABLE class="backlight">
<!--Parameters table: Caption-->
	<thead>
		<TR>
			<td>Part</td>
			<td>Type</td>
			<td>Use</td>
			<td>Description</td>
		</TR>
	</thead>
	
<!--Parameters table: line divider-->
  <TBODY>
<tr class="line" ><td colspan=100></td></tr>

<!--Parameters table: contents-->

	<TR>
		<td class="boldItal"></td>
		<td></td>
		<td></td>
		<td></td>
	</TR>
	<TR>
		<td class="boldItal">pAvatar</td>
		<td>Thing</td>
		<td>Required</td>
		<td>A reference to the avatar who is disconnecting.</td>
	</TR>
</TABLE>
<p>The <b>Disconnect</b> event supports these additional handlers:
<TABLE class="backlight" STYLE="WIDTH:75%">
<!--Parameters table: Caption-->
	<thead>
		<TR>
			<td>Event Handler</td>
			<td>Description</td>

		</TR>
	</thead>
<tr class="line" ><td colspan=100></td></tr>
	<TR>
		<td class="boldItal">OnPeerDisconnect</td>
		<td>The handler for other objects in the same <a href="../Thing/Container.htm">Container</a>.</td>
		<td>The handler for the object's <a href="../Thing/Contents.htm">Contents</a>.</td>
		<td></td>
	</TR>
<TR>
		<td class="boldItal">OnContainerDisconnect</td>
		<td></td>
		<td></td>
		<td></td>
	</TR>
<TR>
		<td class="boldItal">OnContentDisconnect</td>
		<td>The handler for the <b>Container</b> of the object.</td>
		<td></td>
		<td></td>
	</TR>
</TABLE>
<!--Return Value section -->
<H3>Return Value</H3>
<p>
This method does not return a value.

<!--Remarks section-->
<H3>Remarks</H3>
<p>This method responds to an internal <strong>Disconnect</strong> event that occurs in Virtual Worlds when an <b>Avatar</b>
disconnects from (or logs off) the world.

<p>In addition, an overriding <strong>OnDisconnect</strong> method can run on either the client or the server; however, due
to timing issues, it should be specified as a server-side method. 

<p><b>Note</b>:&nbsp;&nbsp;&nbsp;To ensure that the internal procedures that are tied to each event handler are invoked, you must call <b>InvokeSuperMethod</b> within the overridden subroutine. For more information on using this method, see the <a href="../Thing/InvokeSuperMethod.htm">InvokeSuperMethod</a> topic.
<!--Example section-->
<H3>Example</H3>
<p>This example demonstrates an OnPeer implementation of the onDisconnect handler. To use this example, add this subroutine your avatar object, and when another avatar logs off of your world, the subroutine is invoked.<br><br>
<pre class="example">Sub OnPeerDisconnect(Who)
&nbsp;&nbsp;&nbsp;&nbsp;Trace Who.Name &amp; &quot; has disconnected.&quot;
&nbsp;&nbsp;&nbsp;&nbsp;This.InvokeSuperMethod(Who) 
End Sub</pre>



</body>
</html>
